<section class="">
  <!-- Two Cards -->
  <div class="font-Outfit flex w-full justify-center gap-3 items-stretch px-2">
    <!-- Card 1 -->
    <div class="flex-1 p-2">
      <div class="px-3 py-4 sm:px-4 sm:py-6 rounded-xl bg-lightGreen shadow-lg transition-shadow hover:shadow-2xl flex flex-col items-start space-y-3 sm:space-y-6">
        <div class="mb-2 sm:mb-4 bg-gradient-to-r from-green-400 to-green-600 p-2 rounded-full">
          <i class="fa-regular fa-folder text-white text-lg sm:text-xl lg:text-2xl"></i>
        </div>
        <div class="flex flex-col sm:flex-row sm:gap-x-4 md:gap-x-6 lg:gap-x-8 w-full text-lightGray">
          <div class="flex flex-col items-start">
            <p class="text-xs sm:text-sm md:text-base lg:text-lg tracking-wide">Total Inventory</p>
            <p class="pt-1 text-lg sm:text-xl md:text-2xl lg:text-3xl font-semibold tracking-wide"><%= @total_inventory_count.presence || 'N/A' %></p>
          </div>
          <div class="flex flex-col items-start">
            <p class="text-xs sm:text-sm md:text-base lg:text-lg tracking-wide">Cash Per Wk(ugx)</p>
            <p class="pt-1 text-lg sm:text-xl md:text-2xl lg:text-3xl font-semibold tracking-wide"><%= @weekly_cash_inventory_count.presence || 'N/A' %></p>
          </div>
        </div>
      </div>
    </div>
    <!-- Card 2 -->
    <div class="flex-1 p-2">
      <div class="px-3 py-4 sm:px-4 sm:py-6 rounded-xl bg-white shadow-lg transition-shadow hover:shadow-2xl flex flex-col items-start space-y-3 sm:space-y-6">
        <div class="mb-2 sm:mb-4 bg-gradient-to-r from-gray-400 to-gray-600 p-2 rounded-full">
          <i class="fa-solid fa-user-group text-white text-lg sm:text-xl lg:text-2xl"></i>
        </div>
        <div class="flex flex-col sm:flex-row sm:gap-x-4 md:gap-x-6 lg:gap-x-8 w-full text-black">
          <div class="flex flex-col items-start">
            <p class="text-xs sm:text-sm md:text-base lg:text-lg tracking-wide">Food per wk</p>
            <p class="pt-1 text-lg sm:text-xl md:text-2xl lg:text-3xl font-semibold tracking-wide"><%= @weekly_food_inventory_count.presence || 'N/A' %></p>
          </div>
          <div class="flex flex-col items-start">
            <p class="text-xs sm:text-sm md:text-base lg:text-lg tracking-wide">Cloth per wk</p>
            <p class="pt-1 text-lg sm:text-xl md:text-2xl lg:text-3xl font-semibold tracking-wide"><%= @weekly_cloth_inventory_count.presence || 'N/A' %></p>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Section -->
  <div class="font-Outfit flex justify-between items-center p-5">
    <!-- Small screen remove button -->
    <button id="clear-filters-small" class="md:hidden bg-gray-200 p-3 rounded-full flex justify-center items-center shadow-md hover:bg-red-100 transition-all">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
      </svg>
    </button>
    <!-- Page title for medium and larger screens -->
    <p class="hidden md:block font-semibold text-lg text-gray-800">Inventories</p>
    <div class="flex items-center space-x-4">
      <!-- Remove button for medium and larger screens -->
      <div id="clear-filters-large" class="hidden md:flex items-center space-x-2 bg-red-100 hover:bg-red-200 px-4 py-2 rounded-lg shadow-md transition-all cursor-pointer">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
        </svg>
        <p class="text-sm font-medium text-gray-800">Clear</p>
      </div>
      <!-- Filter button -->
      <button id="filter-modal-button" class="border-2 border-gray-300 hover:bg-gray-100 focus:outline-none px-4 py-2 flex items-center space-x-2 rounded-lg shadow-md transition-all">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2a1 1 0 01-.293.707l-6.6 6.6a1 1 0 00-.293.707V17a1 1 0 01-.293.707l-2 2A1 1 0 0110 20v-3.586a1 1 0 00-.293-.707L3.293 6.707A1 1 0 013 6V4z" />
        </svg>
        <span class="text-sm font-medium text-gray-800">Filter</span>
      </button>
    </div>
  </div>
  <!-- Clear Filters Form -->
  <%= form_with url: inventories_path, method: :get, id: "clear-filters-form", local: true do |f| %>
    <%= f.hidden_field :donor_name, value: nil %>
    <%= f.hidden_field :donation_type, value: nil %>
    <%= f.hidden_field :donor_type, value: nil %>
    <%= f.hidden_field :start_date, value: nil %>
    <%= f.hidden_field :end_date, value: nil %>
    <%= f.hidden_field :district_id, value: nil %>
    <%= f.hidden_field :county_id, value: nil %>
    <%= f.hidden_field :sub_county_id, value: nil %>
    <%= f.hidden_field :branch_id, value: nil %>
  <% end %>
  <!-- Filter Modal -->
  <div id="filter-modal" class="fixed inset-0 z-50 hidden bg-gray-900 bg-opacity-50 flex justify-center items-center p-4">
    <div class="bg-white rounded-lg shadow-lg w-full max-w-3xl p-6 max-h-full overflow-y-auto">
      <div class="flex justify-between items-center pb-3 border-b">
        <h3 class="text-lg font-medium text-gray-900">Filter Inventories</h3>
        <button id="close-modal-button" class="text-gray-400 hover:text-gray-600">
          <svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
          </svg>
        </button>
      </div>
      <!-- Filter Form -->
      <%= form_with url: inventories_path, method: :get, local: true, class: "space-y-6 mt-4" do |f| %>
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
          <div class="flex flex-col">
            <%= f.label :donor_name, "Donor Name", class: "font-semibold text-gray-700 mb-2" %>
            <%= f.text_field :donor_name, value: params[:donor_name], class: "mt-1 block w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500" %>
          </div>
          <div class="flex flex-col">
            <%= f.label :donation_type, "Donation Type", class: "font-semibold text-gray-700 mb-2" %>
            <%= f.select :donation_type, options_for_select(["food", "cash", "cloth", "other_items"], params[:donation_type]), { prompt: 'Select donation type' }, class: "mt-1 block w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500" %>
          </div>
          <div class="flex flex-col">
            <%= f.label :donor_type, "Donor Type", class: "font-semibold text-gray-700 mb-2" %>
            <%= f.select :donor_type, options_for_select(["individual_donor", "family_donor", "organization_donor"], params[:donor_type]), { prompt: 'Select donor type' }, class: "mt-1 block w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500" %>
          </div>
          <div class="flex flex-col">
            <%= f.label :district_id, "District", class: "font-semibold text-gray-700 mb-2" %>
            <%= f.collection_select :district_id, @districts, :id, :name, { prompt: "Select District", selected: params[:district_id] }, { id:'district-select', class: 'district-select form-select mt-1 block w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500' } %>
          </div>
          <div class="flex flex-col">
            <%= f.label :county_id, "County", class: "font-semibold text-gray-700 mb-2" %>
            <%= f.collection_select :county_id, @counties, :id, :name, { include_blank: "Select County", selected: params[:county_id] }, { id:'county-select', class: 'county-select form-select mt-1 block w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500' } %>
          </div>
          <div class="flex flex-col">
            <%= f.label :sub_county_id, "Sub County", class: "font-semibold text-gray-700 mb-2" %>
            <%= f.collection_select :sub_county_id, @sub_counties, :id, :name, { include_blank: "Select Sub County", selected: params[:sub_county_id] }, { id:'sub-county-select', class: 'sub-county-select form-select mt-1 block w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500' } %>
          </div>
          <div class="flex flex-col">
            <%= f.label :branch_id, "Branch", class: "font-semibold text-gray-700 mb-2" %>
            <%= f.collection_select :branch_id, @branches, :id, :name, { include_blank: "Select Branch", selected: params[:branch_id] }, { class: 'form-select mt-1 block w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500' } %>
          </div>
          <div class="flex flex-col">
            <%= f.label :start_date, "Start Date", class: "font-semibold text-gray-700 mb-2" %>
            <%= f.date_field :start_date, value: params[:start_date], class: "mt-1 block w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500" %>
          </div>
          <div class="flex flex-col">
            <%= f.label :end_date, "End Date", class: "font-semibold text-gray-700 mb-2" %>
            <%= f.date_field :end_date, value: params[:end_date], class: "mt-1 block w-full p-3 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500" %>
          </div>
        </div>
        <div class="flex justify-end mt-6">
          <%= f.submit "Apply Filters", class: "py-3 px-6 bg-lightGreen text-white font-bold rounded-md shadow-sm hover:bg-green-700 transition-all" %>
        </div>
      <% end %>
    </div>
  </div>
  <!-- Table -->
  <div class="overflow-x-auto">
  <table class="w-full text-sm text-left rtl:text-right text-gray-500">
    <thead class="text-xs text-gray-700 uppercase bg-gray-50">
      <tr>
        <th scope="col" class="px-6 py-3 text-left">
          <span class="flex items-center gap-2">
            Donation Type
            <svg width="10" height="10" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M14 5.16675H2C1.72667 5.16675 1.5 4.94008 1.5 4.66675C1.5 4.39341 1.72667 4.16675 2 4.16675H14C14.2733 4.16675 14.5 4.39341 14.5 4.66675C14.5 4.94008 14.2733 5.16675 14 5.16675Z" fill="#00092E"/>
              <path d="M12 8.5H4C3.72667 8.5 3.5 8.27333 3.5 8C3.5 7.72667 3.72667 7.5 4 7.5H12C12.2733 7.5 12.5 7.72667 12.5 8C12.5 8.27333 12.2733 8.5 12 8.5Z" fill="#00092E"/>
              <path d="M9.33366 11.8333H6.66699C6.39366 11.8333 6.16699 11.6066 6.16699 11.3333C6.16699 11.0599 6.39366 10.8333 6.66699 10.8333H9.33366C9.60699 10.8333 9.83366 11.0599 9.83366 11.3333C9.83366 11.6066 9.60699 11.8333 9.33366 11.8333Z" fill="#00092E"/>
            </svg>
          </span>
        </th>
        <th scope="col" class="px-6 py-3">
          <span class="flex items-center gap-2">
            Donor Type
            <svg width="10" height="10" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M14 5.16675H2C1.72667 5.16675 1.5 4.94008 1.5 4.66675C1.5 4.39341 1.72667 4.16675 2 4.16675H14C14.2733 4.16675 14.5 4.39341 14.5 4.66675C14.5 4.94008 14.2733 5.16675 14 5.16675Z" fill="#00092E"/>
              <path d="M12 8.5H4C3.72667 8.5 3.5 8.27333 3.5 8C3.5 7.72667 3.72667 7.5 4 7.5H12C12.2733 7.5 12.5 7.72667 12.5 8C12.5 8.27333 12.2733 8.5 12 8.5Z" fill="#00092E"/>
              <path d="M9.33366 11.8333H6.66699C6.39366 11.8333 6.16699 11.6066 6.16699 11.3333C6.16699 11.0599 6.39366 10.8333 6.66699 10.8333H9.33366C9.60699 10.8333 9.83366 11.0599 9.83366 11.3333C9.83366 11.6066 9.60699 11.8333 9.33366 11.8333Z" fill="#00092E"/>
            </svg>
          </span>
        </th>
        <th scope="col" class="px-6 py-3">
          <span class="flex items-center gap-2">
            Collection Date
            <svg width="10" height="10" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M14 5.16675H2C1.72667 5.16675 1.5 4.94008 1.5 4.66675C1.5 4.39341 1.72667 4.16675 2 4.16675H14C14.2733 4.16675 14.5 4.39341 14.5 4.66675C14.5 4.94008 14.2733 5.16675 14 5.16675Z" fill="#00092E"/>
              <path d="M12 8.5H4C3.72667 8.5 3.5 8.27333 3.5 8C3.5 7.72667 3.72667 7.5 4 7.5H12C12.2733 7.5 12.5 7.72667 12.5 8C12.5 8.27333 12.2733 8.5 12 8.5Z" fill="#00092E"/>
              <path d="M9.33366 11.8333H6.66699C6.39366 11.8333 6.16699 11.6066 6.16699 11.3333C6.16699 11.0599 6.39366 10.8333 6.66699 10.8333H9.33366C9.60699 10.8333 9.83366 11.0599 9.83366 11.3333C9.83366 11.6066 9.60699 11.8333 9.33366 11.8333Z" fill="#00092E"/>
            </svg>
          </span>
        </th>
        <th scope="col" class="px-6 py-3">
          <span class="flex items-center gap-2">
            Place Of Collection
            <svg width="10" height="10" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M14 5.16675H2C1.72667 5.16675 1.5 4.94008 1.5 4.66675C1.5 4.39341 1.72667 4.16675 2 4.16675H14C14.2733 4.16675 14.5 4.39341 14.5 4.66675C14.5 4.94008 14.2733 5.16675 14 5.16675Z" fill="#00092E"/>
              <path d="M12 8.5H4C3.72667 8.5 3.5 8.27333 3.5 8C3.5 7.72667 3.72667 7.5 4 7.5H12C12.2733 7.5 12.5 7.72667 12.5 8C12.5 8.27333 12.2733 8.5 12 8.5Z" fill="#00092E"/>
              <path d="M9.33366 11.8333H6.66699C6.39366 11.8333 6.16699 11.6066 6.16699 11.3333C6.16699 11.0599 6.39366 10.8333 6.66699 10.8333H9.33366C9.60699 10.8333 9.83366 11.0599 9.83366 11.3333C9.83366 11.6066 9.60699 11.8333 9.33366 11.8333Z" fill="#00092E"/>
            </svg>
          </span>
        </th>
        <th scope="col" class="px-6 py-3">
          <span class="flex items-center gap-2">
            Branch
            <svg width="10" height="10" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M14 5.16675H2C1.72667 5.16675 1.5 4.94008 1.5 4.66675C1.5 4.39341 1.72667 4.16675 2 4.16675H14C14.2733 4.16675 14.5 4.39341 14.5 4.66675C14.5 4.94008 14.2733 5.16675 14 5.16675Z" fill="#00092E"/>
              <path d="M12 8.5H4C3.72667 8.5 3.5 8.27333 3.5 8C3.5 7.72667 3.72667 7.5 4 7.5H12C12.2733 7.5 12.5 7.72667 12.5 8C12.5 8.27333 12.2733 8.5 12 8.5Z" fill="#00092E"/>
              <path d="M9.33366 11.8333H6.66699C6.39366 11.8333 6.16699 11.6066 6.16699 11.3333C6.16699 11.0599 6.39366 10.8333 6.66699 10.8333H9.33366C9.60699 10.8333 9.83366 11.0599 9.83366 11.3333C9.83366 11.6066 9.60699 11.8333 9.33366 11.8333Z" fill="#00092E"/>
            </svg>
          </span>
        </th>
        <th scope="col" class="px-6 py-3">
          <span class="flex items-center gap-2">
            Actions
            <svg width="10" height="10" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M14 5.16675H2C1.72667 5.16675 1.5 4.94008 1.5 4.66675C1.5 4.39341 1.72667 4.16675 2 4.16675H14C14.2733 4.16675 14.5 4.39341 14.5 4.66675C14.5 4.94008 14.2733 5.16675 14 5.16675Z" fill="#00092E"/>
              <path d="M12 8.5H4C3.72667 8.5 3.5 8.27333 3.5 8C3.5 7.72667 3.72667 7.5 4 7.5H12C12.2733 7.5 12.5 7.72667 12.5 8C12.5 8.27333 12.2733 8.5 12 8.5Z" fill="#00092E"/>
              <path d="M9.33366 11.8333H6.66699C6.39366 11.8333 6.16699 11.6066 6.16699 11.3333C6.16699 11.0599 6.39366 10.8333 6.66699 10.8333H9.33366C9.60699 10.8333 9.83366 11.0599 9.83366 11.3333C9.83366 11.6066 9.60699 11.8333 9.33366 11.8333Z" fill="#00092E"/>
            </svg>
          </span>
        </th>
      </tr>
    </thead>
    <tbody>
      <% @inventories.each_with_index do |inventory, index| %>
        <tr class="bg-white border-b hover:bg-gray-50">
          <!-- Donation Type -->
          <th scope="row" class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap">
            <%= inventory.donation_type.present? ? inventory.donation_type.titleize : 'N/A' %>
          </th>
          <!-- Donor Type -->
          <td class="px-6 py-4">
            <%= inventory.donor_type.present? ? inventory.donor_type.titleize : 'N/A' %>
          </td>
          <!-- Collection Date -->
          <td class="px-6 py-4">
            <%= inventory.collection_date.present? ? inventory.collection_date : 'N/A' %>
          </td>
          <!-- Place of collection -->
          <td class="px-6 py-4">
            <%= inventory.place_of_collection.present? ? inventory.place_of_collection : 'N/A' %>
          </td>
          <!-- Branch -->
          <td class="px-6 py-4">
            <%= inventory.branch&.name.present? ? inventory.branch&.name : 'N/A'  %>
          </td>
          <!-- Dropdown Menu for Actions -->
          <td class="px-6 py-4">
            <div class="relative inline-block text-left">
              <button type="button" onclick="toggleDropdown('<%= inventory.id %>', event)" data-request-type="<%= inventory.donation_type %>" class="rounded-md border border-gray-300 shadow-sm p-2 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none flex justify-center items-center">
                Actions
                <svg class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                  <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 011.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" />
                </svg>
              </button>
              <div id="dropdown-<%= inventory.id %>" class="hidden absolute z-10 right-0 <%= 'bottom-full mb-2' if index >= 4 %> w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5">
                <div class="py-1" role="menu" aria-orientation="vertical" aria-labelledby="options-menu">
                  <%= link_to 'Details', inventory_path(inventory), class: 'block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100' %>
                  <%= link_to 'Update', edit_request_inventory_path(inventory.request, inventory), class: 'block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100' %>
                  <%= button_to 'Delete', inventory_path(inventory), method: :delete, data: { confirm: 'Are you sure?' }, class: 'block px-4 py-2 text-sm text-red-600 hover:bg-gray-100' %>
                </div>
              </div>
            </div>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
  </div>
  <!-- Pagination -->
  <div class="pagination-container flex flex-col md:flex-row items-center justify-between p-4 space-y-4 md:space-y-0">
    <!-- Items per page dropdown -->
    <div class="items-per-page flex items-center space-x-2">
      <label for="items-per-page" class="text-sm font-medium text-gray-700">Items per page:</label>
      <select id="items-per-page" name="per_page" onchange="window.location.href='?per_page=' + this.value" class="rounded-lg bg-gray-200 px-2 py-1">
        <% [10, 25, 50, 100, 'All'].each do |count| %>
          <option class="text-sm" value="<%= count == 'All' ? 0 : count %>" <%= 'selected' if count == @per_page || (count == 'All' && @per_page == 0) %>>
          <%= count == 'All' ? 'Show All' : count %>
        </option>
          <% end %>
        </select>
      </div>
      <div class="flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-4">
        <!-- Current page display -->
        <div class="page-display flex items-center space-x-2">
          <input id="current-page" type="number" min="1" max="<%= @total_pages %>" value="<%= @page_no %>" class="rounded-lg px-2 py-1 bg-gray-200 text-center w-12"
        onchange="window.location.href='?page=' + this.value + '&per_page=' + document.getElementById('items-per-page').value">
          <span class="text-sm font-medium text-gray-700">of <%= @total_pages %> pages</span>
        </div>
        <!-- Navigation buttons -->
        <div class="pagination-buttons flex items-center space-x-2">
          <% if @page_no > 1 %>
            <%= link_to '<', inventories_path(page: @page_no - 1, per_page: @per_page), class: "px-3 py-1 bg-gray-200 rounded-lg hover:bg-gray-300 text-gray-700" %>
          <% else %>
            <span class="px-3 py-1 bg-gray-200 rounded-lg text-gray-400 cursor-not-allowed"><</span>
              <% end %>
              <% if @page_no < @total_pages %>
                <%= link_to '>', inventories_path(page: @page_no + 1, per_page: @per_page), class: "px-3 py-1 bg-gray-200 rounded-lg hover:bg-gray-300 text-gray-700" %>
              <% else %>
                <span class="px-3 py-1 bg-gray-200 rounded-lg text-gray-400 cursor-not-allowed">></span>
              <% end %>
            </div>
          </div>
        </div>
      </section>